<mat-toolbar style="background-color:#212529;">
  <ng-container>
    <button (click)="drawer.toggle()" mat-icon-button class="example-icon" aria-label="menu">
      <mat-icon>menu</mat-icon>
    </button>
<!-- ถ้าเป็น /pages/dashboard ให้โชว์ฟอร์ม; ถ้าไม่ใช่ ให้โชว์ข้อความ Data Logger -->
      <span>Data Logger</span>

      <div class="container">
        <div class="row w-100">
          <mat-chip-set aria-label="Fish selection">
            <div class="col-6">
            @if ((isDashboard$  | async) || (isRace$  | async)) {
                <mat-chip matButton  [matMenuTriggerFor]="Event" [disabled]="isDashboard$" style="width: auto;">Event : {{ eventNameSelect }}</mat-chip>
                <mat-menu #Event="matMenu">
                  @for (eventMenuBar of eventList; track eventMenuBar.value) {
                  <button mat-menu-item (click)="navigateToRace(eventMenuBar.value, eventMenuBar.name)"> {{eventMenuBar.name}} </button>
                  }
                </mat-menu>
            }

            @if ((isDashboard$  | async)) {
                <mat-chip matButton [matMenuTriggerFor]="menu" style="width: auto;" disabled >รุ่น : {{ SegmentNameSelect }}</mat-chip>
                <mat-menu #menu="matMenu">
                  @for (segmentMenuBar of SegmentList; track segmentMenuBar.value) {
                  <button mat-menu-item >{{segmentMenuBar.name}} </button>
                  }
                  <!-- @for (item of items; track $index) {
                    <button mat-menu-item (click)="navigateToRace(eventList.event_id)">PickUp</button>
                  } -->
                </mat-menu>

                <mat-chip matButton  [matMenuTriggerFor]="Category" style="width: auto;">Category : {{ SessionNameSelect }}</mat-chip>
                <mat-menu #Category="matMenu">
                  @for (SessionMenuBar of SessionList; track SessionMenuBar.value) {
                  <button mat-menu-item (click)="navigateToDashboard(SessionMenuBar.value)"> {{SessionMenuBar.name}} </button>
                  }
                </mat-menu>
            }
                <mat-chip color="primary" disabled>
                  {{ currentTime() | date:'dd MMM, yyyy HH:mm:ss' }}
                </mat-chip>

            </div>
          </mat-chip-set>
        </div>
      </div>
    <span class="example-spacer"></span>

    <button mat-icon-button class="example-icon" aria-label="profile" [matMenuTriggerFor]="profileMenu">
      <mat-icon>person</mat-icon>
    </button>
    <mat-menu #profileMenu="matMenu">
      <button mat-menu-item disabled>
        Username: {{ (userName$ | async) || '-' }}
      </button>
      <button mat-menu-item (click)="logout()" class="text-center">Logout</button>
    </mat-menu>
  </ng-container>
</mat-toolbar>

<mat-drawer-container autosize style="position:absolute; right:0; left:0; bottom:0; top:60px;">
  <mat-drawer #drawer mode="over" class="toolbar" style="width:250px;">
    <mat-action-list class="side-content">

      @if ((role$ | async) === 'admin' || (role$ | async) === 'scruitineer') {
      <!-- เห็นได้ทั้ง admin + scruitineer -->
      <button (click)="drawer.toggle(); navigateToDashboard(0)" mat-list-item>
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/logger.png"></div>
          <div class="col-10 pt-1">Dashboard</div>
        </div>
      </button>
      }

      @if ((role$ | async) === 'admin') {
      <!-- เฉพาะ admin เท่านั้น -->
      <button (click)="drawer.toggle(); navigateToListAllSeason()" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/race.png"></div>
          <div class="col-10 pt-1">รายการแข่ง ทั้งหมด</div>
        </div>
      </button>

      <!-- <button (click)="drawer.toggle(); navigateToAddSeason('0ms','0ms')" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/dashboard.png"></div>
          <div class="col-10 pt-1">เพิ่มรายการ</div>
        </div>
      </button> -->

      <button (click)="drawer.toggle(); navigateToListSettingLogger()" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/setting-logger.png"></div>
          <div class="col-10 pt-1">ตั้งค่า Logger</div>
        </div>
      </button>

      <button (click)="drawer.toggle(); navigateToListConfigAFR2()" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/setting-logger.png"></div>
          <div class="col-10 pt-1">Admin Config</div>
        </div>
      </button>

      <button (click)="drawer.toggle(); navigateToListConfigAFR('0ms','0ms')" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/config-setting.png"></div>
          <div class="col-10 pt-1">AFR Config</div>
        </div>
      </button>


      }
      <button (click)="drawer.toggle(); navigateToLogout()" mat-list-item >
        <div class="row">
          <div class="col-2"><img style="border-radius:0; height:28px;" src="images/icon/exit-icon.png"></div>
          <div class="col-10 pt-1">Logout</div>
        </div>
      </button>

    </mat-action-list>
  </mat-drawer>

  <router-outlet></router-outlet>
</mat-drawer-container>
